<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
  <title>GemAd - Earn Telegram Stars!</title>
  <link rel="stylesheet" href="/reset.css">
  <link rel="stylesheet" href="/styles.css">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&display=swap" rel="stylesheet">
  <style>
    .page { display: none; }
    .page.active { display: flex; }

  </style>
</head>
<body>
  <header>
  <div class="header__content">
    <div class="user-info">
      <div class="logo info-item">
     
        <img class="user-icon" id="avatar" src="" alt="avatar">
      </div>
      <div class="user-stat">

        <div class="user-name info-item" id="name"></div>

        <div class="stars-earned info-item" id="stars-earned">Earned: 0 ‚≠ê</div>
      </div>
    </div>
    <div class="user-balance info-item">

       <p class="stars-balance"> <span id="stars-balance">0 ‚≠ê</span></p>
    </div>
  </div>
</header>
  <main>
    <!-- Page 1 -->
    <section id="page-ad" class="page active">
      <div class="section-header">
        <div class="section-header__content">
          <h1 class="section__title">All available ads: </h1>
          <div class="search-container">
            <input id="searchInput" type="text" placeholder="Search by hashtag... (#fun, #business)" autocomplete="off"/>
            <ul id="suggestionsList" class="suggestions"></ul>
          </div>
          <p id="noResults" class="no-results">Nothing found üòï Try another hashtag</p>
          <div class="section-header__blocks">
            <!-- block -->
            <div class="ad-block" data-tag="#recommended #info #gem-ad">
              <div class="ad-block__head">
                <img class="ad-block__img" src="images/GemAd.jpg" alt="item">
              </div>
              <div class="ad-block__bottom">
                
                  <div class="ad-block__title">GemAd</div>
                
                <div class="ad-block__description">
                  <div class="ad-block__username">@GemAdChannel</div>
                  <div class="ad-block__desc block-bottom__item">The official channel of this mini app</div>
                  <div class="ad-block__hashtags">
                  <div class="hashtag-recommended">#recommended</div> 
                  <div class="ad-block__hashtag">#info</div>
                  <div class="ad-block__hashtag">#gem-ad</div>
                  </div>
                    <a href="https://t.me/GemAdChannel" class="ad-link ad-link__mobile block-bottom__item">Subscribe 1500 ‚≠ê</a>
                </div>
              </div>
            </div>
            <!-- block -->
            <div class="ad-block" data-tag="#gifts #stars #recommended">
              <div class="ad-block__head">
                <video class="ad-block__video" src="images/giftchanges.mp4" autoplay muted loop playsinline></video>
              </div>
              <div class="ad-block__bottom">
                
                  <div class="ad-block__title">Gift Changes üéÅ</div>
                
                <div class="ad-block__description">
                  <div class="ad-block__username">@GiftChanges</div>
                  <div class="ad-block__desc block-bottom__item">Channel about gift changes</div>
                  <div class="ad-block__hashtags">
                  <div class="hashtag-recommended">#recommended</div>
                  <div class="ad-block__hashtag">#gifts</div> 
                  <div class="ad-block__hashtag">#stars</div>
                  
                  </div>
                    <a href="https://t.me/miy_bloh" class="ad-link ad-link__mobile block-bottom__item">Subscribe 14 ‚≠ê</a>
                </div>
              </div>
            </div>




          
            <!-- block -->
            <div class="ad-block" data-tag="#father #business #pavel">
              <div class="ad-block__head">
                <img class="ad-block__img" src="images/durov.jpg" alt="item">
              </div>
              <div class="ad-block__bottom">
                
                  <div class="ad-block__title">Pavel Durov</div>
                
                <div class="ad-block__description">
                  <div class="ad-block__username">@paveldurov</div>
                  <div class="ad-block__desc block-bottom__item">Official Telegram of Pavel Durov</div>
                  <div class="ad-block__hashtags">
                  <div class="ad-block__hashtag">#business</div> 
                  <div class="ad-block__hashtag">#father</div>
                  <div class="ad-block__hashtag">#pavel</div>
                  
                  </div>
                    <a href="https://t.me/durov" class="ad-link ad-link__mobile block-bottom__item">Subscribe 15 ‚≠ê</a>
                </div>
              </div>
            </div>
            
            <!-- block -->
            <div class="ad-block" data-tag="#fun #monkeys #bradochki">
              <div class="ad-block__head">
                <img class="ad-block__img" src="images/monkeys.jpg" alt="item">
              </div>
              <div class="ad-block__bottom">
                
                  <div class="ad-block__title">Bibizyanki</div>
                
                <div class="ad-block__description">
                  <div class="ad-block__username">@bibizyankimonk</div>
                  <div class="ad-block__desc block-bottom__item">Channel about monkeys</div>
                  <div class="ad-block__hashtags">
                  <div class="ad-block__hashtag">#fun</div> 
                  <div class="ad-block__hashtag">#monkeys</div>
                  <div class="ad-block__hashtag">#bradochki</div>
                  </div>
                    <a href="https://t.me/SonataStudio" class="ad-link ad-link__mobile block-bottom__item">Subscribe 15 ‚≠ê</a>
                </div>
              </div>
            </div>


          </div>
        </div>
      </div>
    </section>

    <!-- cases -->
    <section id="page-cases" class="page">
  <div class="section-cases">
    <div class="section-cases__content">
      <h1 class="section__title">Cases: </h1>
      <div class="section-cases__blocks"> 

        <a class="case-block" href="#" onclick="showPage('case-durov', event)">
          <div class="case-block__head">
            <img class="case-block__img" src="images/durov.jpg" alt="item">
          </div>
          <div class="case-block__bottom">
            <h2 class="case-block__title">Durov's Case</h2>
            <div class="case-block__desc">Try your luck and win stars!</div>
            <div class="case-block__price">Price: 200 ‚≠ê</div>
          </div>
        </a>

      </div>

      <a class="back-button" href="#" onclick="showPage('page-ad', event)">
        <img style="width: 30px; height: 30px;" src="images/left-arrow.svg" alt="back">
      </a>
    </div>
  </div>
</section>


    <section id="case-durov" class="page">
      <div class="case-durov">
      <h1 class="section__title">Durov's Case</h1>
      <div class="viewport" id="viewport">
    <div class="strip" id="strip"></div>
    <div class="indicator" aria-hidden="true"></div>
  </div>

  <button class="spin-btn" id="spin">Spin 200 ‚≠ê</button>
  <div id="result"></div>
      <a class="back-button" href="#" onclick="showPage('page-cases', event)"> <img style="width: 30px; height: 30px;" src="images/left-arrow.svg" alt="back"> </a>
      
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer>
    <div class="footer">
      <ul class="footer-nav">
        <li class="footer-nav__item active">
  <a class="ad-navigation" href="#" onclick="showPage('page-ad', event)">Ad <img class="svg" src="images/ad.svg" alt="ad-navigation"></a>
</li>
<li class="footer-nav__item">
  <a class="ad-navigation" href="#" onclick="showPage('page-cases', event)">Cases <img class="svg" src="images/case.svg" alt="case-nav"> </a>
</li>
      </ul>
    </div>
  </footer>

  <!-- tg + nav -->
   <script src="spin.js"></script>
<script>
  const tg = window.Telegram.WebApp;
  tg.expand();

  // nav
  window.showPage = function(pageId, event) {
    if (event) event.preventDefault();

    document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
    const page = document.getElementById(pageId);
    if (page) page.classList.add("active");

    document.querySelectorAll(".footer-nav__item").forEach(i => i.classList.remove("active"));
    const link = document.querySelector(`.footer-nav__item a[onclick*="${pageId}"]`);
    if (link) link.parentElement.classList.add("active");

    history.pushState({ page: pageId }, "", `#${pageId}`);
  }


  window.addEventListener("popstate", e => {
    const page = e.state?.page || "page-ad";
    window.showPage(page);
  });

</script>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const tg = window.Telegram.WebApp;
  const searchInput = document.getElementById('searchInput');
  const suggestionsList = document.getElementById('suggestionsList');
  const adBlocks = document.querySelectorAll('.ad-block');
  const noResults = document.getElementById('noResults');
  const footer = document.querySelector('footer');
  const main = document.querySelector('main');

  tg.expand();

  let hashtags = [];
  adBlocks.forEach(block => {
    const tagsAttr = block.dataset.tag || '';
    const tags = tagsAttr.split(' ')
      .map(t => t.trim())
      .filter(t => t.startsWith('#') && t.length > 1);
    hashtags.push(...tags);
  });
  hashtags = [...new Set(hashtags)];

  searchInput.addEventListener('input', () => {
    const query = searchInput.value.trim().toLowerCase();
    suggestionsList.innerHTML = '';

    if (query) {
      const filtered = hashtags.filter(tag => tag.toLowerCase().includes(query));
      if (filtered.length) {
        filtered.forEach(tag => {
          const li = document.createElement('li');
          li.textContent = tag;
          li.addEventListener('click', () => {
            searchInput.value = tag;
            suggestionsList.style.display = 'none';
            searchInput.dispatchEvent(new Event('input'));
          });
          suggestionsList.appendChild(li);
        });
        suggestionsList.style.display = 'block';
      } else {
        suggestionsList.style.display = 'none';
      }
    } else {
      suggestionsList.style.display = 'none';
    }

    let found = 0;
    adBlocks.forEach(block => {
      const tagsAttr = block.dataset.tag || '';
      const tags = tagsAttr.split(' ').map(t => t.trim().toLowerCase());
      const title = block.querySelector('.ad-block__title')?.textContent.toLowerCase() || '';
      const matches = tags.some(tag => tag.includes(query)) || title.includes(query) || query === '';
      block.style.display = matches ? '' : 'none';
      if (matches) found++;

      block.querySelectorAll('.ad-block__hashtag').forEach(h => {
        h.classList.remove('highlight');
        if (query && h.textContent.toLowerCase().includes(query)) {
          h.classList.add('highlight');
        }
      });
    });

    noResults.style.display = (found === 0 && query !== '') ? 'block' : 'none';
  });

  document.addEventListener('click', e => {
    if (!e.target.closest('.search-container')) {
      suggestionsList.style.display = 'none';
    }
  });

  // ‚úÖ –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ—É—Ç–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –≤—ã—Å–∫–∞–∫–∏–≤–∞–µ—Ç –Ω–∞–¥ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π
  footer.style.position = 'fixed';
  footer.style.bottom = '0';
  footer.style.left = '0';
  footer.style.right = '0';
  footer.style.zIndex = '100';
  footer.style.transition = 'opacity 0.25s ease';

  // Telegram –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–æ–±—â–∞–µ—Ç, –∫–æ–≥–¥–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –æ—Ç–∫—Ä—ã—Ç–∞
  tg.onEvent('viewportChanged', ({ isStateStable, height }) => {
    if (!isStateStable) return;

    const fullHeight = tg.viewportStableHeight;
    const keyboardOpened = height < fullHeight - 100;

    // –ï—Å–ª–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –æ—Ç–∫—Ä—ã—Ç–∞ ‚Äî –ø—Ä–æ—Å—Ç–æ "–æ—Ç–ø—É—Å–∫–∞–µ–º" —Ñ—É—Ç–µ—Ä –≤–Ω–∏–∑,
    // —á—Ç–æ–±—ã Telegram –Ω–µ —Ç—è–Ω—É–ª –µ–≥–æ –Ω–∞–¥ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π.
    if (keyboardOpened) {
      footer.style.position = 'absolute';
      footer.style.bottom = '0';
    } else {
      footer.style.position = 'fixed';
      footer.style.bottom = '0';
    }
  });

});
</script>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const hashtagsClickable = document.querySelectorAll('.ad-block__hashtag, .hashtag-recommended');
  const searchInput = document.getElementById('searchInput');
  const suggestionsList = document.getElementById('suggestionsList');

  hashtagsClickable.forEach(tag => {
    tag.style.cursor = 'pointer';
    tag.addEventListener('click', () => {
      const tagText = tag.textContent.trim();
      window.showPage('page-ad');
      searchInput.value = tagText;
      suggestionsList.style.display = 'none';
      searchInput.dispatchEvent(new Event('input'));
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
  });
});
</script>


  <div id="telegram-messages"></div>


  <script src="telegram.js"></script> 
  <script src="spin.js"></script>
</body>
</html>
